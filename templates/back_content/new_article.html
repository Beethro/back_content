{% extends "admin/core/base.html" %}
{% load foundation %}
{% load static from staticfiles %}
{% load securitytags %}
{% load files %}
{% load i18n %}

{% block title %}Back Content Submission{% endblock %}

{% block breadcrumbs %}
    {{ block.super }}
    <li><a href="{% url 'bc_index' %}">Back Content Plugin</a></li>
{% endblock breadcrumbs %}

{% block body %}
    <section class="content">
        <div class="row expanded">
            <div class="box">
                <div class="title-area">
                    <h2>{% trans "New Article" %}</h2>
                </div>
                <div class="content">
                    <p>{% trans "To submit an article, click the start button below" %}.</p>
                    <form method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <button type="submit" class="success button"><i class="fa fa-upload">&nbsp;</i>{% trans "Start Submission" %}</button>
                        <a href="{% url 'bc_xml_import_upload' %}" class="success button"><i class="fa fa-upload">&nbsp;</i>
                            {% trans "Submit JATS XML for Import" %}</a>
                        <a href="{% url 'bc_doi_import' %}" class="success button"><i class="fa fa-upload">&nbsp;</i>
                            {% trans "Import Metadata from DOI or URL" %}</a>
                    </form>
                </div>
                <div class="title-area">
                    <h2>{% trans "Existing Articles" %}</h2>
                </div>
                <div class="content">
                    <table class="table table-bordered" id="unassigned">
                        <thead>
                        <tr>
                            <th>{% trans "Title" %}</th>
                            <th>{% trans "Submitted" %}</th>
                            <th>{% trans "Main Author" %}</th>
                            <th>{% trans "Section" %}</th>
                            <th>{% trans "Actions" %}</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for article in articles %}
                            <tr>
                                <td>{{ article.title }}</td>
                                <td>{{ article.date_submitted }}</td>
                                <td>{{ article.correspondence_author.full_name }}</td>
                                <td>{{ article.section.name }}</td>
                                <td>
                                    <div class="btn-group">
                                        <a href="{% url 'bc_article' article.pk %}" class="btn btn-secondary">{% trans "View" %}</a>
                                        <a href="{% url 'bc_delete_article' article.pk %}" class="btn btn-secondary confirm_delete">{% trans "Delete" %}</a>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td>{% trans "No articles in this stage" %}</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block js %}
    {% include "elements/datatables.html" with target="#unassigned" %}
    <script type="text/javascript">
        $('.confirm_delete').on('click', function () {
            return confirm('Are you sure?');
        });
    </script>    
{% endblock %}

{% block css %}
<style rel="stylesheet">
    .btn-group > a {
        margin-left: 6px;
        margin-right: 6px;
    }
</style>
{% endblock %}

